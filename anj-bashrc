[[ $- != *i* ]] && return

# set xkbmap -option caps:escape

namespace=""
hf_token=""
export OPENAI_API_KEY=""
export HF_API_KEY=""
export HUGGING_FACE_HUB_TOKEN=""

alias l='ls -ltrh'

# Neovim if possible
# alias vim='nvim'
# alias vimclear='rm -rf ~/.local/state/nvim/swap/*'

# Mongo
alias mongods='nohup mongod > /dev/null 2>&1 & disown'
alias mongodk='killall mongod'
alias mongoshs='nohup mongosh > /dev/null 2>&1 & disown'
alias mongoshk='killall mongosh'

# NPM
alias npms='nohup npm start > /dev/null 2>&1 & disown'
alias npmk='killall node'

# Docker
alias dockerkill='sudo docker stop $(sudo docker ps -a -q)'
alias dockerrm='sudo docker rm $(sudo docker ps -a -q)'

# VM
vms() {
    vm_name=$1
    VBoxManage startvm "$vm_name" --type headless
}
vmk() {
    vm_name=$1
    VBoxManage controlvm "$vm_name" acpipowerbutton
}

# K8s
kr() {
    job=$1
    kubectl delete -f $1
    kubectl apply -f $1
}

# Discord
alias dcs='nohup ~/Executables/Discord/Discord > /dev/null 2>&1 & disown'
dcsi() {
    cd ~/Downloads/
    tgz=$(ls discord*.tar.gz | sort | tail -n1)
    echo $tgz
    tar xzf $tgz
    sudo rm -rf ~/Executables/Discord/
    cp -r ~/Downloads/Discord ~/Executables/Discord
    sudo chown root:root ~/Executables/Discord/chrome-sandbox
    sudo chmod 4755 ~/Executables/Discord/chrome-sandbox
    dcs
}

# Cursor
# alias cursor='nohup ~/Executables/Cursor/AppRun > /dev/null 2>&1 & disown'

# Git
alias gsh='git stash'
alias gshp='git stash pop'
alias gs='git status'
alias ga='git add'
alias gc='git commit -m'
alias gd='git diff --color'
alias gdh='git diff --color HEAD~'
alias gb='git branch --color'
alias gx='git checkout'
alias gl='git log --color'
alias glg='git log --graph --oneline --decorate --all --color'
# alias gdv='git difftool -y -t vimdiff -- '
# function gdv() { vimdiff <(git show HEAD:"$1") "$1"; }
function gdv() {
  [ $# -eq 1 ] || { echo "usage: gdv <path>" >&2; return 2; }
  f=$1
  tmp="$(mktemp "${TMPDIR:-/tmp}/gdv.XXXXXX")" || return 1
  trap 'rm -f "$tmp"' EXIT INT TERM
  git show "HEAD:$f" >"$tmp" || return 1

  vim -d "$tmp" "$f" \
    -c 'wincmd h | setl ro noma' \
    -c 'wincmd l | setl noro ma'
}


# function gdv() {
#   [ $# -ge 1 ] || { echo "usage: gdv <path> [<path> ...]" >&2; return 2; }
#   local f
#   for f in "$@"; do
#     (
#       tmp="$(mktemp "${TMPDIR:-/tmp}/gdv.XXXXXX")" || exit 1
#       trap 'rm -f "$tmp"' EXIT INT TERM
#       git show "HEAD:$f" >"$tmp" 2>/dev/null || { echo "gdv: not in HEAD: $f" >&2; exit 1; }
#       vimdiff "$tmp" "$f"
#     )
#   done
# }

# Media
alias png='xdg-open'
alias mp4='vlc'
pdf() {
    zathura "$@" &
}

# Update main branch for the current git fork
function ff-main {
    git switch main
    git fetch upstream
    git pull --ff-only upstream main
    git push origin main
}

# University account -> ajoukov@cs.stonybrook.edu
gua() {
    export GIT_SSH_COMMAND='ssh -i ~/.ssh/id_ed25519_cs_sbu -o IdentitiesOnly=yes'
    eval $(ssh-agent)
    ssh-add ~/.ssh/id_ed25519_cs_sbu
    git config --global user.name  "Alexander Joukov"
    git config --global user.email "ajoukov@cs.stonybrook.edu"
}
# Personal account -> Aapteryx@gmail.com
guA() {
    export GIT_SSH_COMMAND='ssh -i ~/.ssh/id_github_personal -o IdentitiesOnly=yes'
    eval $(ssh-agent)
    ssh-add ~/.ssh/id_github_personal
    git config --global user.name  "Alexander Joukov"
    git config --global user.email "Aapteryx@gmail.com"
}
# modelizeIT account -> ajoukov@modelizeIT.com
gum() {
    # export GIT_SSH_COMMAND='ssh -i ~/.ssh/id_ecdsa_github_mit -o IdentitiesOnly=yes'
    # eval $(ssh-agent)
    # ssh-add ~/.ssh/id_ecdsa_github_mit
    git config --global user.name  "Alexander Joukov"
    git config --global user.email "ajoukov@modelizeIT.com"
}

# Set volume
v() {
    pactl set-sink-volume @DEFAULT_SINK@ $@%
}

# Util
alias unique='sort | uniq'

# modelizeIT
alias log='vim $(ls -Art RejuvenApptor* | tail -n 1)'
alias logg='vim $(ls -Art Gatherer-UI* | tail -n 1)'
alias logj='vim $(ls -Art Gatherer-JR* | tail -n 1)'

mntcrypt() {
    sudo cryptsetup luksOpen /dev/sdb cryptroot
    sudo mount /dev/mapper/cryptroot /mnt/crypt
}

alias mr="(make debug -C ~/mgit-tmp/RejuvenApptor/;  ~/mIT/bin/RejuvenApptor-start.sh)"
alias mg="(make debug -C ~/mgit-tmp/Gatherer/;  ~/mIT/bin/Gatherer-UI.sh; ~/mIT/bin/Gatherer-JobRunner.sh)"

PATH=/home/sasha/bin:$PATH

# https://apple.stackexchange.com/questions/446859/when-pasting-in-terminal-app-00-is-pasted-at-the-start-and-01-at-the-end
# Prevent 00~[text]01~ when copy + pasting
echo;printf '\e[?2004l';echo

clear
